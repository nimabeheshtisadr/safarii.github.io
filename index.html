<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <title>Ú†Ø±Ø® Ø´Ø§Ù†Ø³ Ù¾ÙÚ©ÛŒ Ø¨Ø§ ØµØ¯Ø§</title>
  <style>
    @font-face {
      font-family: 'VazirBold';
      src: url('https://cdn.fontcdn.ir/Font/Persian/Vazir/Vazir-Bold.woff2');
    }
    @font-face {
      font-family: 'Vazir';
      src: url('https://cdn.fontcdn.ir/Font/Persian/Vazir/Vazir.woff2');
    }
    body {
      font-family: 'VazirBold', sans-serif;
      direction: rtl;
      text-align: center;
      background: #f07c24;
      padding-top: 20px;
      margin: 0;
    }
    h2 {
      color: #000000;
      font-size: 2.2em;
      text-shadow: 3px 3px 0 #ffcdd2, 5px 5px 0 rgba(0,0,0,0.1);
      margin-bottom: 30px;
    }
    .container {
      max-width: 550px;
      margin: 0 auto;
      padding: 20px;
      position: relative;
    }
    .wheel-container {
      position: relative;
      display: inline-block;
      margin: 0 auto;
    }
    canvas {
      background: #fff;
      border-radius: 50%;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      padding: 10px;
      display: block;
    }
    button {
      margin-top: 30px;
      font-size: 2.5em;
      padding: 15px 40px;
      border: none;
      border-radius: 50px;
      background: #ff5252;
      color: white;
      cursor: pointer;
      font-family: 'VazirBold';
      box-shadow: 0 5px 15px rgba(255, 82, 82, 0.4);
      transition: all 0.3s;
    }
    button:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(255, 82, 82, 0.6);
    }
    button:disabled {
      background: #bdbdbd;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }
    .center-logo {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 120px;
      height: 120px;
      z-index: 5;
      pointer-events: none;
      border-radius: 50%;
      border: 5px solid white;
      box-shadow: 0 0 10px rgba(0,0,0,0.2);
      object-fit: cover;
    }
    .win-message {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(255, 255, 255, 0.95);
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 20px rgba(0,0,0,0.3);
      z-index: 20;
      display: none;
      text-align: center;
      max-width: 80%;
      animation: celebration 0.5s ease infinite alternate;
    }
    @keyframes celebration {
      0% { transform: translate(-50%, -50%) scale(1); }
      100% { transform: translate(-50%, -50%) scale(1.05); }
    }
    .win-message h3 {
      color: #d32f2f;
      margin: 0;
      font-size: 1.5em;
    }
    .win-message p {
      margin: 10px 0;
      font-size: 2em;
    }
    .celebration-emoji {
      font-size: 5em;
      margin: 10px 0;
      animation: float 1s ease-in-out infinite alternate;
    }
    @keyframes float {
      from { transform: translateY(0); }
      to { transform: translateY(-10px); }
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>ğŸªÙØ§Ù„Ùˆ ÛŒØ§Ø¯Øª Ù†Ø±Ù‡ Ø¨Ú†Ø±Ø®ÙˆÙ† Ø¨Ø±Ù†Ø¯Ù‡ Ø´Ùˆ Ø³Ø§ÙØ§Ø±ÛŒ Ù¾Ø§Ø±Ú© ğŸ¡</h2>
    
    <div class="wheel-container">
      <canvas id="wheelCanvas" width="500" height="500"></canvas>
      <img src="logo.png" class="center-logo" alt="Ù„ÙˆÚ¯Ùˆ Ù…Ø±Ú©Ø²">
      <div id="winMessage" class="win-message">
        <div class="celebration-emoji">ğŸ‰</div>
        <h3>  Ù†ØªÛŒØ¬Ù‡ Ø´Ø§Ù†Ø³Øª </h3>
        <p id="prizeText"></p>
        <div class="celebration-emoji">Ø¹Ú©Ø³Ø´ Ùˆ Ø¨ÙØ±Ø³Øª Ø¨Ù‡ Ø§ÛŒÙ†Ø³ØªØ§Ù…ÙˆÙ†</div>
      </div>
    </div>
    
    <button id="spinButton">Ø¨Ú†Ø±Ø®ÙˆÙ†</button>
  </div>

  <!-- ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ ØµÙˆØªÛŒ Ù…Ø­Ù„ÛŒ -->
  <audio id="spinSound" preload="auto">
    <source src="spin.mp3" type="audio/mpeg">
  </audio>
  <audio id="winSound" preload="auto">
    <source src="win.mp3" type="audio/mpeg">
  </audio>

  <script>
    // Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ú†Ø±Ø® Ø´Ø§Ù†Ø³
    const items = [
      { name: ' Ø¨Ù† ØªØ®ÙÛŒÙ', weight: 95, color: '#FFD3B6' },
      { name: 'Ú©Ø§Ø±ØªÛŒÙ†Ú¯', weight: 0, color: '#FFAAA5' },
      { name: 'Ø²ÛŒÙ¾ Ù„Ø§ÛŒÙ†', weight: 0, color: '#DCEDC2' },
      { name: 'ØªØ®ÙÛŒÙ Ù‚Ø§ÛŒÙ‚ Ù…ÙˆØªÙˆØ±ÛŒ', weight: 2, color: '#A8E6CE' },
      { name: 'Ù¾ÙˆÚ†', weight: 0, color: '#FF8C94' },
	  { name: 'ØªÙˆÙ†Ù„ ÙˆØ­Ø´Øª', weight: 3, color: '#f2e441' },
      { name: 'Ø³Ø§ÙØ§Ø±ÛŒ', weight: 0, color: '#D4A5A5' }
    ];

    // ØªÙ†Ø¸ÛŒÙ…Ø§Øª Canvas
    const canvas = document.getElementById("wheelCanvas");
    const ctx = canvas.getContext("2d");
    const centerX = canvas.width / 2;
    const centerY = canvas.height / 2;
    const radius = 200;
    const anglePerSegment = (2 * Math.PI) / items.length;

    let startAngle = 0;
    let spinning = false;
    let hasSpun = false;
    const spinButton = document.getElementById("spinButton");
    const winMessage = document.getElementById("winMessage");
    const prizeText = document.getElementById("prizeText");
    const spinSound = document.getElementById("spinSound");
    const winSound = document.getElementById("winSound");

    // ØªØ§Ø¨Ø¹ Ø±Ø³Ù… Ú†Ø±Ø®
    function drawWheel() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.save();
      ctx.translate(centerX, centerY);
      ctx.rotate(startAngle);

      // Ø±Ø³Ù… Ø¨Ø®Ø´â€ŒÙ‡Ø§ÛŒ Ú†Ø±Ø®
      for (let i = 0; i < items.length; i++) {
        const start = i * anglePerSegment;
        const end = start + anglePerSegment;

        ctx.beginPath();
        ctx.moveTo(0, 0);
        ctx.arc(0, 0, radius, start, end);
        ctx.fillStyle = items[i].color;
        ctx.fill();
        ctx.strokeStyle = "#fff";
        ctx.lineWidth = 3;
        ctx.stroke();

        // Ù…ØªÙ† Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§
        ctx.save();
        ctx.rotate(start + anglePerSegment / 2);
        ctx.textAlign = "center";
        ctx.font = "bold 16px 'VazirBold'";
        ctx.fillStyle = "#333";
        
        const text = items[i].name;
        if (text.length > 10) {
          const parts = text.split(' ');
          ctx.fillText(parts[0], radius * 0.7, -5);
          ctx.fillText(parts[1] || '', radius * 0.7, 15);
        } else {
          ctx.fillText(text, radius * 0.7, 5);
        }
        
        ctx.restore();
      }

      ctx.restore();

      // Ø¯Ø§ÛŒØ±Ù‡ ÙˆØ³Ø· Ú†Ø±Ø® (Ú©ÙˆÚ†Ú©ØªØ± Ø´Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ Ù„ÙˆÚ¯Ùˆ)
      ctx.beginPath();
      ctx.arc(centerX, centerY, 30, 0, 2 * Math.PI);
      ctx.fillStyle = "#8a8786";
      ctx.fill();
      ctx.strokeStyle = "#fff";
      ctx.lineWidth = 5;
      ctx.stroke();
    }

    // Ø§Ù†ØªØ®Ø§Ø¨ ØªØµØ§Ø¯ÙÛŒ Ø¨Ø§ ÙˆØ²Ù†â€ŒØ¯Ù‡ÛŒ
    function weightedRandom(items) {
      const totalWeight = items.reduce((sum, item) => sum + item.weight, 0);
      let rand = Math.random() * totalWeight;
      for (let item of items) {
        if (rand < item.weight) return item;
        rand -= item.weight;
      }
    }

    // ØªØ§Ø¨Ø¹ Ú†Ø±Ø®Ø´ Ú†Ø±Ø® Ø¨Ø§ ØªÙˆÙ‚Ù Ø¯Ù‚ÛŒÙ‚
    function spinWheel() {
      if (spinning || hasSpun) return;
      spinning = true;
      spinButton.disabled = true;
      winMessage.style.display = "none";

      // Ù¾Ø®Ø´ ØµØ¯Ø§ÛŒ Ú†Ø±Ø®Ø´
      spinSound.currentTime = 0;
      spinSound.play().catch(e => {
        console.error('Ø®Ø·Ø§ Ø¯Ø± Ù¾Ø®Ø´ ØµØ¯Ø§ÛŒ Ú†Ø±Ø®Ø´:', e);
        // Ø±Ø§Ù‡Ú©Ø§Ø± Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ† Ø¨Ø±Ø§ÛŒ Ù…Ø±ÙˆØ±Ú¯Ø±Ù‡Ø§ÛŒÛŒ Ú©Ù‡ ØµØ¯Ø§ Ø±Ø§ Ù…Ø³Ø¯ÙˆØ¯ Ù…ÛŒâ€ŒÚ©Ù†Ù†Ø¯
        document.body.addEventListener('click', function enableSound() {
          spinSound.play();
          document.body.removeEventListener('click', enableSound);
        }, { once: true });
      });

      // Ø§Ù†ØªØ®Ø§Ø¨ Ø¬Ø§ÛŒØ²Ù‡
      const selectedPrize = weightedRandom(items);
      const prizeIndex = items.findIndex(item => item.name === selectedPrize.name);
      
      // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø²Ø§ÙˆÛŒÙ‡ ØªÙˆÙ‚Ù Ø¨Ø§ Ø¯Ù‚Øª Ø¨Ø§Ù„Ø§
      const targetAngle = (prizeIndex * anglePerSegment) + (anglePerSegment / 2);
      const currentAngle = startAngle % (2 * Math.PI);
      const rotations = 10; // ØªØ¹Ø¯Ø§Ø¯ Ø¯ÙˆØ±Ù‡Ø§ÛŒ Ú†Ø±Ø®Ø´
      
      // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø²Ø§ÙˆÛŒÙ‡ Ú©Ù„ Ø¨Ø±Ø§ÛŒ ØªÙˆÙ‚Ù Ø¯Ù‚ÛŒÙ‚
      let totalRotation = (rotations * 2 * Math.PI) + (2 * Math.PI - currentAngle - targetAngle);
      
      const duration = 5000;
      const startTime = performance.now();

      // Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ú†Ø±Ø®Ø´ Ø¨Ø§ ØªÙˆÙ‚Ù Ø¯Ù‚ÛŒÙ‚
      function animate(currentTime) {
        const elapsed = currentTime - startTime;
        const progress = Math.min(elapsed / duration, 1);
        
        // ØªØ§Ø¨Ø¹ easing Ø¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹ Ø³Ø±ÛŒØ¹ Ùˆ Ù¾Ø§ÛŒØ§Ù† Ø¢Ø±Ø§Ù…
        const easing = (t) => {
          if (t < 0.7) return t / 0.7;
          return 0.7 + (1 - Math.pow(1 - ((t - 0.7) / 0.3), 4)) * 0.3;
        };
        
        const easedProgress = easing(progress);
        startAngle = totalRotation * easedProgress;
        drawWheel();
        
        if (progress < 1) {
          requestAnimationFrame(animate);
        } else {
          // ØªÙ†Ø¸ÛŒÙ… Ø¯Ù‚ÛŒÙ‚ Ø²Ø§ÙˆÛŒÙ‡ Ù†Ù‡Ø§ÛŒÛŒ Ø¨Ø±Ø§ÛŒ ØªÙˆÙ‚Ù Ú©Ø§Ù…Ù„ Ø±ÙˆÛŒ Ø¬Ø§ÛŒØ²Ù‡
          startAngle = 2 * Math.PI - targetAngle;
          drawWheel();
          
          spinning = false;
          hasSpun = true;
          
          // ØªÙˆÙ‚Ù ØµØ¯Ø§ÛŒ Ú†Ø±Ø®Ø´ Ùˆ Ù¾Ø®Ø´ ØµØ¯Ø§ÛŒ Ø¨Ø±Ù†Ø¯Ù‡ Ø´Ø¯Ù†
          spinSound.pause();
          winSound.currentTime = 0;
          winSound.play().catch(e => {
            console.error('Ø®Ø·Ø§ Ø¯Ø± Ù¾Ø®Ø´ ØµØ¯Ø§ÛŒ Ø¨Ø±Ù†Ø¯Ù‡ Ø´Ø¯Ù†:', e);
            // Ø±Ø§Ù‡Ú©Ø§Ø± Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ†
            document.body.addEventListener('click', function enableSound() {
              winSound.play();
              document.body.removeEventListener('click', enableSound);
            }, { once: true });
          });
          
          // Ù†Ù…Ø§ÛŒØ´ Ù¾ÛŒØ§Ù… Ø¨Ø±Ù†Ø¯Ù‡ Ø´Ø¯Ù† Ø±ÙˆÛŒ Ú¯Ø±Ø¯ÙˆÙ†Ù‡
          prizeText.textContent = selectedPrize.name;
          winMessage.style.display = "block";
        }
      }

      requestAnimationFrame(animate);
    }

    // Ø±ÙˆÛŒØ¯Ø§Ø¯ Ú©Ù„ÛŒÚ© Ø¨Ø±Ø§ÛŒ Ø¯Ú©Ù…Ù‡ Ú†Ø±Ø®Ø´
    spinButton.addEventListener('click', spinWheel);

    // ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† ØµØ¯Ø§Ù‡Ø§ Ø¨Ø§ Ø§ÙˆÙ„ÛŒÙ† ØªØ¹Ø§Ù…Ù„ Ú©Ø§Ø±Ø¨Ø±
    function enableSounds() {
      spinSound.volume = 0.5;
      winSound.volume = 0.7;
      console.log('ØµØ¯Ø§Ù‡Ø§ ÙØ¹Ø§Ù„ Ø´Ø¯Ù†Ø¯');
      document.body.removeEventListener('click', enableSounds);
    }
    document.body.addEventListener('click', enableSounds);

    // Ø¨Ø±Ø±Ø³ÛŒ Ø®Ø·Ø§Ù‡Ø§ÛŒ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù„ÙˆÚ¯Ùˆ
    document.querySelector('.center-logo').addEventListener('error', function() {
      console.error('Ù„ÙˆÚ¯Ùˆ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù†Ø´Ø¯. Ø§Ø² Ù„ÙˆÚ¯ÙˆÛŒ Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ† Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯.');
      this.src = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48Y2lyY2xlIGN4PSI1MCIgY3k9IjUwIiByPSI0MCIgZmlsbD0iI2ZmNTI1MiIvPjx0ZXh0IHg9IjUwIiB5PSI1NSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1zaXplPSIyMCIgZmlsbD0iI2ZmZiI+8J+OiTwvdGV4dD48L3N2Zz4=';
    });

    // Ø±Ø³Ù… Ø§ÙˆÙ„ÛŒÙ‡ Ú†Ø±Ø®
    drawWheel();
  </script>
</body>
</html>
